
---

### **API调用文档（精简版）**

---

#### **1. 用户认证**
| 方法 | 路径              | 说明         | 请求参数                          | 成功响应                          |
|------|-------------------|--------------|-----------------------------------|-----------------------------------|
| POST | `/register`       | 用户注册     | `username`, `public_key`（SM2公钥） | 201: `{"message": "注册成功"}`    |
| POST | `/login`          | 用户登录     | `username`                        | 200: `{"token": "SM2加密Token"}`  |
| POST | `/refresh-token`  | 刷新Token    | 无（通过Header传递当前Token）      | 200: `{"token": "新Token"}`       |

---

#### **2. 应急事件管理**
| 方法 | 路径                      | 说明             | 请求参数                                                                 | 成功响应                                  |
|------|---------------------------|------------------|--------------------------------------------------------------------------|-------------------------------------------|
| POST | `/incidents`              | 创建事件         | `incident_info`（SM4加密）, `incident_level`, `process_status`          | 201: `{"message": "事件创建成功", "incident_id": 1001}` |
| GET  | `/incidents/<incident_id>`| 查询事件详情     | 无（路径参数`incident_id`）                                              | 200: `{"incident_level": 2, "process_status": 1}` |

---

#### **3. 安全检查**
| 方法 | 路径                      | 说明             | 请求参数                          | 成功响应                              |
|------|---------------------------|------------------|-----------------------------------|---------------------------------------|
| POST | `/security-checks`        | 提交安全检查     | `check_record`（SM4加密）, `improvement_status` | 201: `{"check_id": 2001}`             |
| GET  | `/security-checks/<check_id>` | 查询检查报告 | 无（路径参数`check_id`）          | 200: `{"improvement_status": 3, "evaluation_report": "..."}` |

---

#### **4. 用户管理**
| 方法 | 路径               | 说明         | 请求参数                          | 权限要求       | 成功响应                          |
|------|--------------------|--------------|-----------------------------------|----------------|-----------------------------------|
| POST | `/users`           | 创建用户     | `username`, `role_level`          | 管理员（role_level=1） | 201: `{"message": "用户创建成功"}` |
| GET  | `/users/<user_id>` | 查询用户信息 | 无（路径参数`user_id`）            | 所有认证用户  | 200: `{"username": "test", "role_level": 1}` |

---

#### **5. 错误码**
| 状态码 | 说明                  | 典型场景                         |
|--------|-----------------------|----------------------------------|
| 401    | Token无效或缺失       | 未提供Token/Token解密失败        |
| 403    | 权限不足              | 普通用户调用管理员接口           |
| 404    | 资源不存在            | 查询不存在的`incident_id`        |
| 429    | 请求频率超限          | 登录失败超过5次                  |

---

#### **6. 请求示例（创建事件）**
```http
POST /incidents HTTP/1.1
Authorization: Bearer SM2加密的Token
Content-Type: application/json

{
  "incident_info": "加密后的文本",  # SM4加密
  "incident_level": 2,
  "process_status": 1
}
```

